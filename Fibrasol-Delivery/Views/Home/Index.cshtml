@{
    ViewData["Title"] = "Dashboard";
}

<link rel="stylesheet" href="~/css/home/index.css" />

<div class="dashboard-container">
    <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="mb-2"><i class="bi bi-speedometer2 me-3"></i>Dashboard</h1>
                <p class="mb-0 opacity-75">Resumen general del sistema de entregas</p>
            </div>
            <div class="text-end">
                <p class="mb-0 opacity-75">Última actualización</p>
                <p class="mb-0" id="lastUpdate">Cargando...</p>
            </div>
        </div>
    </div>

    <div class="row g-4">
        <!-- Drivers Card -->
        <div class="col-xl col-lg-4 col-md-6">
            <div class="dashboard-card card-drivers">
                <div class="card-icon">
                    <i class="bi bi-person-badge"></i>
                </div>
                <h6 class="card-title">Mensajeros</h6>
                <div class="card-number" id="driversCount">
                    <div class="loading-spinner"></div>
                </div>
                <p class="card-subtitle">Total de mensajeros registrados</p>
            </div>
        </div>

        <!-- Clients Card -->
        <div class="col-xl col-lg-4 col-md-6">
            <div class="dashboard-card card-clients">
                <div class="card-icon">
                    <i class="bi bi-people"></i>
                </div>
                <h6 class="card-title">Clientes</h6>
                <div class="card-number" id="clientsCount">
                    <div class="loading-spinner"></div>
                </div>
                <p class="card-subtitle">Total de clientes activos</p>
            </div>
        </div>

        <!-- SalesPersons Card -->
        <div class="col-xl col-lg-4 col-md-6">
            <div class="dashboard-card card-salespersons">
                <div class="card-icon">
                    <i class="bi bi-person-badge-fill"></i>
                </div>
                <h6 class="card-title">Vendedores</h6>
                <div class="card-number" id="salesPersonsCount">
                    <div class="loading-spinner"></div>
                </div>
                <p class="card-subtitle">Total de vendedores registrados</p>
            </div>
        </div>

        <!-- Delivery Orders Card -->
        <div class="col-xl col-lg-4 col-md-6">
            <div class="dashboard-card card-orders">
                <div class="card-icon">
                    <i class="bi bi-truck"></i>
                </div>
                <h6 class="card-title">Órdenes de Entrega</h6>
                <div class="card-number" id="ordersCount">
                    <div class="loading-spinner"></div>
                </div>
                <p class="card-subtitle">Total de órdenes gestionadas</p>
            </div>
        </div>

        <!-- Invoices Card -->
        <div class="col-xl col-lg-4 col-md-6">
            <div class="dashboard-card card-invoices">
                <div class="card-icon">
                    <i class="bi bi-receipt"></i>
                </div>
                <h6 class="card-title">Facturas</h6>
                <div class="card-number" id="invoicesCount">
                    <div class="loading-spinner"></div>
                </div>
                <div class="invoice-comparison">
                    <div class="progress-bar">
                        <div class="progress-fill" id="invoicesProgress"></div>
                    </div>
                    <div class="progress-text" id="invoicesText">0/0 firmadas</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Unsigned Delivery Orders Section -->
    <div class="table-container">
        <div class="table-section-header">
            <h3><i class="bi bi-exclamation-triangle-fill me-2"></i>Órdenes Pendientes de Firma</h3>
            <span class="badge">Sin Firmar</span>
        </div>
        <table id="unsignedOrdersTable" class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Itinerario</th>
                    <th>Estado</th>
                    <th>Fecha Creación</th>
                    <th>Total</th>
                    <th width="140">Acciones</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data will be loaded via AJAX -->
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script src="~/js/site.min.js"></script>

    <!-- DataTables CSS and JS -->
    <link rel="stylesheet" href="~/lib/datatables/css/dataTables.bootstrap5.min.css">
    <script src="~/lib/datatables/js/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatables/js/dataTables.bootstrap5.min.js"></script>

    <script src="~/js/home/index.min.js"></script>
}